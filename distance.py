#!/usr/bin/env python3
"""========================================================================
Purpose:
    The purpose of this subroutine is to perform the distance formula.

        Inputs:
            1. x1   --> x-1 value
            2. y1   --> y-1 value
            3. z1   --> z-1 value
            4. x2   --> x-2 value
            5. y2   --> y-2 value
            6. z2   --> z-2 value

        Outputs:
            1. dist --> distance

    **** Unit tested on 10/28/2019 ****

Author:
    Emilio Torres
========================================================================"""
#=========================================================================#
# Preamble                                                                #
#=========================================================================#
#-------------------------------------------------------------------------#
# Python packages                                                         #
#-------------------------------------------------------------------------#
import sys
from subprocess import call
import numpy as np
#=========================================================================#
# User defined functions                                                  #
#=========================================================================#
#-------------------------------------------------------------------------#
# Distance formula                                                        #
#-------------------------------------------------------------------------#
def distance(
        X1,                 # X1 value
        Y1,                 # Y1 value
        Z1,                 # Z1 value
        X2,                 # X2 value
        Y2,                 # Y2 value
        Z2):                # Z2 value

    """ Calculating the distance between two points """
    #---------------------------------------------------------------------#
    # Distance formula                                                    #
    #---------------------------------------------------------------------#
    dist        = (X1-X2)**2.0
    dist        += (Y1-Y2)**2.0
    dist        += (Z1-Z2)**2.0
    dist        = (dist)**0.5

    return dist
#=========================================================================#
# Main                                                                    #
#=========================================================================#
if __name__ == "__main__":
    #---------------------------------------------------------------------#
    # Main preamble                                                       #
    #---------------------------------------------------------------------#
    call(["clear"])
    #---------------------------------------------------------------------#
    # Defining the x, y, and z points                                     #
    #---------------------------------------------------------------------#
    x1      = np.array([1.0,2.50,3.40,-1.20, -2.30])
    y1      = np.array([-0.25, 0.37, 5.20, 8.50, -1.20])
    z1      = np.array([0.5, 0.12, 2.0, -3.5, 1.2])
    x2      = np.array([0.25, -1.45, 0.32, 2.30, -1.08])
    y2      = np.array([0.28, 1.58, 8.52, -7.35, -2.05])
    z2      = np.array([0.26, -1.32, 2.54, 0.53, 12.5])
    sols    = np.array([0.949210198, 4.374951428, 4.56074553, 16.72463453,\
                            11.3974076])
    #---------------------------------------------------------------------#
    # Defining the testing variables                                      #
    #---------------------------------------------------------------------#
    tol         = 1e-08
    #---------------------------------------------------------------------#
    # Defining the testing variables                                      #
    #---------------------------------------------------------------------#
    max_err     = -145.0
    #---------------------------------------------------------------------#
    # Looping over the testing variables                                  #
    #---------------------------------------------------------------------#
    for i, sol in enumerate(sols,0):
        calc    = distance(x1[i], y1[i], z1[i], x2[i], y2[i], z2[i])
        err     = abs((calc - sol)/sol)
        if err < tol:
            results = "***** Test #%i passed \t\t error= = %.5e \t\t calc = %.7f \t\t exp = %.7f"\
                                    %(i + 1, err, calc, sol)
            print(results)
        else:
            results = "***** Test #%i failed \t\t error= = %.5e \t\t calc = %.7f \t\t exp = %.7f"\
                                    %(i + 1, err, calc, sol)
            print(results)

    sys.exit(0)
